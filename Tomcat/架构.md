[toc]

### http工作原理

> HTTP协议是浏览器与服务器之间的数据传输协议。作为应用层协议，HTTP是基于TCP/IP协议来传输数据的（HTML文件/图片/查询结果等）。HTTP协议不涉及数据包（Packet）传输，主要规定了客户端与服务端的通信格式。
>
> ![image-20200922174920100](images/image-20200922174920100.png)

### http服务器请求处理

> ![image-20200922175437089](images/image-20200922175437089.png)
>
> ![image-20200922175815228](images/image-20200922175815228.png)

### servlet容器工作流程

> ![image-20200922175910911](images/image-20200922175910911.png)

### Tomcat结构

> ![image-20200922192822342](images/image-20200922192822342.png)

### 连接器-Coyote

> ![image-20200922193053477](images/image-20200922193053477.png)
>
> ![image-20200922193106982](images/image-20200922193106982.png)
>
> ![image-20200922193531285](images/image-20200922193531285.png)
>
> ![image-20200922193742888](images/image-20200922193742888.png)
>
> ![image-20200922193824968](images/image-20200922193824968.png)

#### 连接器组件

> ![image-20200922194007128](images/image-20200922194007128.png)
>
> ![image-20200922194359572](images/image-20200922194359572.png)
>
> ![image-20200922194416504](images/image-20200922194416504.png)

### 容器-Catalina

> ![image-20200922194544021](images/image-20200922194544021.png)
>
> ![image-20200922194645786](images/image-20200922194645786.png)

#### Catalina结构

> ![image-20200922194955636](images/image-20200922194955636.png)
>
> ![image-20200922195153323](images/image-20200922195153323.png)
>
> ![image-20200922195420932](images/image-20200922195420932.png)
>
> ![image-20200922195502791](images/image-20200922195502791.png)
>
> ![image-20200922195958926](images/image-20200922195958926.png)
>
> ![image-20200922200134136](images/image-20200922200134136.png)
>
> ![image-20200922200209033](images/image-20200922200209033.png)

### Tomcat启动流程

> ![image-20200922200738258](images/image-20200922200738258.png)
>
> ![image-20200922201136407](images/image-20200922201136407.png)

### Tomcat请求处理流程

> ![image-20200922202246368](images/image-20200922202246368.png)
>
> ![image-20200922202755945](images/image-20200922202755945.png)

### Jasper

> ![image-20200922202844318](images/image-20200922202844318.png)

### Tomcat服务器配置

#### server.xml

> ![image-20200922204024700](images/image-20200922204024700.png)
>
> ![image-20200922204147621](images/image-20200922204147621.png)
>
> ![image-20200922204253411](images/image-20200922204253411.png)
>
> ![image-20200922204335192](images/image-20200922204335192.png)
>
> ![image-20200922204519225](images/image-20200922204519225.png)
>
> **java jdk bin下`jconsole.exe`可以用来监控指定线程**  
>
> ![image-20200922205518482](images/image-20200922205518482.png)
>
> ![image-20200922205749499](images/image-20200922205749499.png)
>
> ![image-20200922210320825](images/image-20200922210320825.png)
>
> ![image-20200922210457143](images/image-20200922210457143.png)
>
> ![image-20200922210521018](images/image-20200922210521018.png)
>
> ![image-20200922210711217](images/image-20200922210711217.png)
>
> ![image-20200922211944441](images/image-20200922211944441.png)
>
> ![image-20200922212032298](images/image-20200922212032298.png)
>
> ![image-20200922212352302](images/image-20200922212352302.png)

### tomcatusers.xml

> 主要用来配置tomcat用户、角色等信息，用来控制tomcat中的manager,host-manager的访问权限

### web应用配置

> ![image-20200922214016924](images/image-20200922214016924.png)
>
> ![image-20200922214352580](images/image-20200922214352580.png)
>
> ![image-20200922214938519](images/image-20200922214938519.png)
>
> ![image-20200922214903747](images/image-20200922214903747.png)
>
> ![image-20200922215144103](images/image-20200922215144103.png)
>
> ![image-20200922215254588](images/image-20200922215254588.png)
>
> ![image-20200922215555268](images/image-20200922215555268.png)
>
> ![image-20200922220348465](images/image-20200922220348465.png)
>
> ![image-20200922220545893](images/image-20200922220545893.png)
>
> ![image-20200922220907228](images/image-20200922220907228.png)
>
> ![image-20200922220943726](images/image-20200922220943726.png)
>
> ![image-20200922221027852](images/image-20200922221027852.png)
>
> ![image-20200922221351986](images/image-20200922221351986.png)

### Tomcat管理配置

> ![image-20200922221659154](images/image-20200922221659154.png)
>
> ![image-20200922233357624](images/image-20200922233357624.png)
>
> 

### JVM配置

> ![image-20200922233612498](images/image-20200922233612498.png)
>
> ![image-20200922233740542](images/image-20200922233740542.png)
>
> ![image-20200922233908543](images/image-20200922233908543.png)

### Tomcat集群

> ![image-20200922234816431](images/image-20200922234816431.png)
>
> ![image-20200922235014992](images/image-20200922235014992.png)
>
> ![image-20200922235215342](images/image-20200922235215342.png)
>
> ![image-20200922235754449](images/image-20200922235754449.png)
>
> ![image-20200922235824313](images/image-20200922235824313.png)
>
> ![image-20200922235956718](images/image-20200922235956718.png)
>
> ![image-20200923000228666](images/image-20200923000228666.png)
>
> ![image-20200923000529755](images/image-20200923000529755.png)
>
> ![image-20200923000914671](images/image-20200923000914671.png)
>
> ![image-20200923001139121](images/image-20200923001139121.png)
>
> 参考tomcat官方文档：https://tomcat.apache.org/tomcat-9.0-doc/cluster-howto.html
> ![image-20200923002422839](images/image-20200923002422839.png)
>
> session复制只在小型集群上应用，大型集群一般不用，因为会造成资源浪费。
>
> ![image-20200923002502819](images/image-20200923002502819.png)

### Tomcat安全

> ![image-20200923002741967](images/image-20200923002741967.png)
>
> ![image-20200923003549514](images/image-20200923003549514.png)
>
> ![image-20200923003738534](images/image-20200923003738534.png)
>
> ![image-20200923004123871](images/image-20200923004123871.png)
>
> ![image-20200923004244919](images/image-20200923004244919.png)
>
> ![image-20200923004339232](images/image-20200923004339232.png)
>
> 在tomcat安装目录下，打开命令行界面，然后输入上图所示命令
>
> keytool :JDK bin目录下提供的工具
>
> ![image-20200923004700482](images/image-20200923004700482.png)
>
> 

### Tomcat性能调优

> ![image-20200923101410487](images/image-20200923101410487.png)
>
> ![image-20200923101634214](images/image-20200923101634214.png)
>
> ![image-20200923102747247](images/image-20200923102747247.png)
>
> ![image-20200923103122635](images/image-20200923103122635.png)
>
> ![image-20200923103538782](images/image-20200923103538782.png)
>
> ![image-20200923103632684](images/image-20200923103632684.png)
>
> ![image-20200923103728427](images/image-20200923103728427.png)
>
> ![image-20200923104117528](images/image-20200923104117528.png)
>
> ![image-20200923104655922](images/image-20200923104655922.png)
>
> ![image-20200923110014635](images/image-20200923110014635.png)
>
> ![image-20200923110531222](images/image-20200923110531222.png)
>
> ![image-20200923110651971](images/image-20200923110651971.png)
>
> ![image-20200923110814300](images/image-20200923110814300.png)
>
> ![image-20200923111523407](images/image-20200923111523407.png)
>
> ![image-20200923111545927](images/image-20200923111545927.png)
>
> ![image-20200923111732258](images/image-20200923111732258.png)
>
> ![image-20200923112506244](images/image-20200923112506244.png)

### Socket介绍

> ![image-20200923113219078](images/image-20200923113219078.png)
>
> ![image-20200923113507261](images/image-20200923113507261.png)
>
> ![image-20200923113539148](images/image-20200923113539148.png)
>
> ![image-20200923113729158](images/image-20200923113729158.png)
>
> ![image-20200923113900832](images/image-20200923113900832.png)
>
> ![image-20200923114014445](images/image-20200923114014445.png)
>
> ![image-20200923114406848](images/image-20200923114406848.png)
>
> 

### 扩展学习

1. SwitchHost 修改 hosts 文件，配置IP与域名映射
2. `telnet 127.0.0.1 8005`



### 参考资料

1. https://www.bilibili.com/video/BV1dJ411N7Um?p=17